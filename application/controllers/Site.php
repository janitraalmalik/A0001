<?phpdefined('BASEPATH') OR exit('No direct script access allowed');class Site extends MX_Controller {			public function __construct(){		parent::__construct();	}			public function index(){                    $roleSession = $this->session->userdata('roleSession');                     if(!empty($roleSession['roleName']) || $roleSession['roleName'] != ''){            redirect(site_url('/site/role'));        }       		$this->page->template('login_tpl');		$this->page->view();	}		public function login(){		$username = $this->input->post('username');		$pass 	  = $this->input->post('password');		$password = password($pass);				$src = $this->db->get_where('users', array (			'username' 	=> $username,			'password'	=> $password,		));				if ($src->num_rows() == 0) {			$this->session->set_flashdata('status', 'failed');			redirect(base_url());		}		else {		                $user = '';            $roleUser = '';                                     foreach($src->result() as $row){                $user = array(                                        'UserId' => $row->id,                                        'userName' => $row->username,                                        'groupUser' => $row->id_users_group_fk,                                        'fullName' => $row->name_users                                    );                             }			$this->session->set_userdata('userSession', $user);                        $getRole = $this->db->join('jns_usaha b', 'a.jns_usaha_id = b.id')                                    ->where('user_id', $src->row()->id)                                    ->get('users_jns_usaha a');                          if($getRole->num_rows() == 1){                            foreach($getRole->result() as $row){                    $roleUser = array(                                            'roleId' => $row->jns_usaha_id,                                            'roleCd' => $row->jns_usaha_kd,                                            'roleName' => $row->nama                                        );                                 }                                $this->session->set_userdata('roleSession', $roleUser);                                redirect(site_url('/dashboard'));                            }                        redirect(site_url('/dashboard'));            		}	}    	public function logout(){		$this->session->sess_destroy();		redirect(base_url());	}	}/* End of file site.php *//* Location: ./application/controllers/site.php */